<h1 class="px-4 py-2 text-3xl font-bold text-gray-700 mt-6 mb-6 text-center">ホーム画面</h1>
<div class="container mx-auto p-4 mb-8">
  <div class="bg-teal-500 text-white rounded-t-lg px-6 py-3 font-bold text-lg">
    ご利用の手引き
  </div>
  <div class="bg-gray-50 border-l border-r border-b border-gray-200 rounded-b-lg p-6 mb-2">
    <div class="mb-4">
      <p class="font-semibold text-gray-700 mb-2">LooMaは以下のメニューから構成され、織物生産プロセスを総合的に管理できます：</p>
      <ol class="list-decimal pl-6 space-y-2 text-gray-700">
        <li><span class="font-medium">ホーム画面</span> - 作業状況の簡易更新ができます</li>
        <li><span class="font-medium">織機一覧</span> - 織機の稼働状況および割当状況を確認できます</li>
        <li><span class="font-medium">織機の登録</span> - 織機の新規登録ができます</li>
        <li><span class="font-medium">受注一覧</span> - 現在の受注情報と進捗状況を確認・管理できます</li>
      </ol>
    </div>
    <!-- 修正したTipsセクション -->
    <div class="flex items-center border-t border-gray-200 pt-4">
      <div class="flex-shrink-0 text-teal-500 mr-2">
        <i class="fas fa-info-circle"></i>
      </div>
      <div class="text-gray-700">
        <p class="mb-1">本ページで各織機の状態更新ボタンは、注文に織機が割当されている時のみ有効です。</p>
        <p>「作業開始」は製織工程以前の前工程を全て完了として製織工程を開始します</p>
        <p>「作業終了」は製織工程を作業完了として、整理加工工程を開始します</p>
      </div>
    </div>
  </div>
</div>

<section class="w-full px-4 py-6">
    <% if @machines.any? %>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <% @machine_status_data.each do |data| %>
                <% machine = data[:machine] %>
                <div class="w-full px-2 py-2">
                    <table class="w-full bg-white shadow rounded-lg overflow-hidden border-collapse border border-gray-200">
                        <tbody>
                            <tr>
                                <th class="w-1/4 px-4 py-4 text-gray-700 font-bold text-left border-b">織機名</th>
                                <td class="w-1/4 px-4 py-4 text-gray-700 text-center border-b"><%= machine&.name %></td>
                            </tr>
                            <tr>
                                <th class="w-1/4 px-4 py-4 text-gray-700 font-bold text-left border-b">現在の作業状況</th>
                                <td class="w-1/4 px-4 py-4 text-gray-700 text-center border-b"><%= work_process_name(machine) %></td>
                            </tr>
                            <tr>
                                <th class="w-1/4 px-4 py-4 text-gray-700 font-bold text-left border-b">織機の稼働状況</th>
                                <td class="w-1/4 px-4 py-4 text-gray-700 text-center border-b"><%= machine&.latest_machine_status&.name %></td>
                            </tr>
                            <tr>
                                <% Rails.logger.debug "▼data  = #{data.inspect}" %>
                                <td colspan="2" class="px-4 py-2">
                                    <div class="flex justify-center space-x-2">
                                    <%= form_with url: update_home_path, method: :patch, local: true,
                                        html:   (data[:confirm_text].present? ?
                                                { onsubmit: "return confirm('#{j data[:confirm_text]}');" } : {}) do %>
                                            <%= hidden_field_tag :machine_id, machine.id %>
                                            <%= hidden_field_tag :order_id, data[:order_id] %>
                                            <%= submit_tag data[:button_label], name: 'commit',
                                                        class: "rounded-full w-32 h-32 text-white text-xl font-semibold #{data[:button_disabled] ? 'bg-gray-300 cursor-not-allowed' : 'bg-blue-500 hover:bg-blue-700'}",
                                                        disabled: data[:button_disabled]
                                                        %>
                                    <% end %>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            <% end %>
        </div>
    <% else %>
        <p class="text-center text-rose-500">表示するデータがありません。</p>
    <% end %>
</section>
